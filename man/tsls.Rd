% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/various_proc_LP.R
\name{tsls}
\alias{tsls}
\title{Two-Stage Least Squares (2SLS) estimation with HAC covariance}
\usage{
tsls(Y, X, Z, q)
}
\arguments{
\item{Y}{Numeric matrix of dimension \eqn{T \times 1} containing the dependent
variable.}

\item{X}{Numeric matrix of dimension \eqn{T \times k} containing the regressors
(potentially endogenous).}

\item{Z}{Numeric matrix of dimension \eqn{T \times m} containing the
instrumental variables.}

\item{q}{Non-negative integer specifying the lag truncation parameter used in
the Newey–West long-run variance estimator.}
}
\value{
A list with components:
\itemize{
  \item \code{b.iv}: A \eqn{k \times 1} vector of 2SLS coefficient estimates.
  \item \code{covmat.b.iv}: A \eqn{k \times k} HAC covariance matrix of the
  estimator.
}
}
\description{
Computes the two-stage least squares (2SLS) estimator of a linear regression
model using instrumental variables, with a heteroskedasticity- and
autocorrelation-consistent (HAC) covariance matrix based on a Newey–West
long-run variance estimator.

The model is:
\deqn{Y = X \beta + \varepsilon,}
where \eqn{X} may be endogenous and \eqn{Z} is a matrix of instruments.
}
\examples{
set.seed(123)
T <- 200

Z <- matrix(rnorm(T * 2), T, 2)
X <- cbind(1, Z[,1] + 0.5 * rnorm(T))
Y <- X \%*\% c(1, 2) + rnorm(T)

res <- tsls(Y = as.matrix(Y), X = X, Z = Z, q = 4)
res$b.iv
res$covmat.b.iv


}
