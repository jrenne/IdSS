% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/various_proc_basics.R
\name{simul.VAR}
\alias{simul.VAR}
\title{Simulate a (S)VAR Process}
\usage{
simul.VAR(
  c,
  Phi,
  B,
  nb.sim,
  y0.star = NaN,
  indic.IRF = 0,
  u.shock = 0,
  eta = NaN
)
}
\arguments{
\item{c}{Numeric vector of length \eqn{n}; the intercept term.}

\item{Phi}{A list, each element of which is a \eqn{Phi_i} matrix. Hence it has p elements if we consider a VAR(p).}

\item{B}{Numeric \eqn{n \times n} matrix; contemporaneous impact matrix
mapping structural shocks \eqn{u_t}to the reduced-form residuals.}

\item{nb.sim}{Integer; number of simulated periods to produce (horizon).}

\item{y0.star}{Numeric vector of length \eqn{n p}; initial companion-state
. Required when
 \code{indic.IRF == 0}. Default is \code{NaN}.}

\item{indic.IRF}{Integer flag. If \code{0} (default), run a forward
simulation from \code{y0.star}. If non-zero, compute an IRF.}

\item{u.shock}{Numeric vector of length n; one-time structural shock used only in IRF mode.}

\item{eta}{Optional matrix of dimension \code{nb.sim x n} containing the
structural shocks \eqn{u_t} to use in simulation mode. If supplied, these are
used; otherwise \eqn{u_t \sim \mathcal{N}(0, I_n)} is generated.}
}
\value{
A numeric matrix of size \code{nb.sim x n}:
  simulated series in simulation mode, or the IRF path in IRF mode.
}
\description{
This function has two modes, controlled by \code{indic.IRF}:
\itemize{
 \item 1) Simulation mode (default, \code{indic.IRF == 0}):
starting from the initial state \code{y0.star}, simulates
\code{nb.sim} periods of a VAR(p).
If \code{eta} is supplied (an \code{nb.sim x n} matrix), its rows are used as
the structural shocks. Otherwise shocks are generated as i.i.d. standard
normal and then mapped by \code{B}.
The result is an \code{nb.sim x n} matrix of simulated observations.
\item 2) IRF mode (\code{indic.IRF != 0}):
compute a finite-horizon impulse response to a one-time structural shock
(length n). At t = 1, the state is set to the effect
of \code{u.shock} through \code{B}; for t >= 2 the system evolves
deterministically using the companion dynamics (i.e., no further shocks).
The output is an \code{nb.sim x n} matrix containing the IRF
path. In IRF mode, \code{eta} is ignored. }
}
\examples{
##  Example with (n = 2, p = 2)
Phi <- list(
  matrix(c(0.5, 0.1, 0.0, 0.3), 2, 2, byrow = TRUE),
  matrix(c(0.2, 0.0, 0.0, 0.1), 2, 2, byrow = TRUE)
)
B  <- diag(2)
c0 <- c(0, 0)
y0 <- rep(0, length(Phi) * nrow(Phi[[1]]))

## 1) Simulation
set.seed(1)
Y  <- simul.VAR(c0, Phi, B, nb.sim = 10, y0.star = y0)

## 2) IRF (unit shock in variable 1)
irf <- simul.VAR(c0, Phi, B, nb.sim = 12, y0.star = y0,
                 indic.IRF = 1, u.shock = c(1, 0))

}
