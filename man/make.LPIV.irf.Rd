% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/various_proc_LP.R
\name{make.LPIV.irf}
\alias{make.LPIV.irf}
\title{Local Projection IV impulse response functions (LP-IV)}
\usage{
make.LPIV.irf(
  Y,
  Z,
  nb.periods.IRF = 20,
  nb.lags.Y.4.control = 0,
  nb.lags.Z.4.control = 0,
  indic.plot = 1,
  confidence.interval = 0.9
)
}
\arguments{
\item{Y}{Numeric matrix of dimension \eqn{T \times n} containing the endogenous
variables. The first column is interpreted as the shock variable whose impulse
responses are traced out.}

\item{Z}{Numeric matrix of dimension \eqn{T \times m} containing the instrument(s)
for the shock variable.}

\item{nb.periods.IRF}{Non-negative integer specifying the maximum horizon
\eqn{H} for which impulse responses are computed.}

\item{nb.lags.Y.4.control}{Non-negative integer specifying the number of lags
of \code{Y} included as control variables in each local projection.

' @param nb.lags.Z.4.control Non-negative integer specifying the number of lags
of \code{Z} included as control variables in each local projection.}

\item{indic.plot}{Logical or integer (1/0). If equal to 1, impulse responses
with confidence intervals are plotted.}

\item{confidence.interval}{Numeric scalar in \eqn{(0,1)} specifying the
confidence level used to construct pointwise confidence intervals.}
}
\value{
A list with components:
\itemize{
  \item \code{IRFs}: A matrix of dimension \eqn{(H+1) \times n} containing the
  estimated impulse responses for each variable and horizon.
  \item \code{all.stdv.IRFs}: A matrix of dimension \eqn{(H+1) \times n}
  containing the corresponding standard errors.
}
}
\description{
Computes impulse response functions (IRFs) using the Local Projection
Instrumental Variables (LP-IV) approach. For each horizon \eqn{h}, the function
estimates a separate IV regression of future outcomes on a shock proxy,
instrumented by \code{Z}, optionally controlling for lags of the endogenous
variables and the instrument.

By convention, the shock is normalized to have a unit effect on the first
column of \code{Y}.
}
\details{
Let \eqn{Y_t} be an \eqn{n}-dimensional vector of endogenous variables and
\eqn{Z_t} an instrument. For each horizon \eqn{h = 0, \dots, H} and each variable
\eqn{i = 1, \dots, n}, the function estimates:
\deqn{
Y_{i,t+h} = \alpha_{i,h} + \beta_{i,h} Y_{1,t} + \Gamma_{i,h}' W_t + u_{i,t+h},
}
using two-stage least squares, where:
\itemize{
  \item \eqn{Y_{1,t}} is the shock variable (first column of \code{Y}),
  \item \eqn{Z_t} is the instrument for \eqn{Y_{1,t}},
  \item \eqn{W_t} includes optional lags of \code{Y} and \code{Z},
  \item a constant is always included.
}

The coefficient \eqn{\beta_{i,h}} is interpreted as the impulse response of
variable \eqn{i} at horizon \eqn{h}. Standard errors are obtained from the
HAC-corrected covariance matrix returned by \code{\link{tsls}}, using a
Neweyâ€“West lag length of \code{h + 1}.
}
\examples{
data("USmonthly_1990_to_2012")
indic.shock.name <- which(names(USmonthly_1990_to_2012)\%in\%c("FF4_TC","ED2_TC"))
Z <- as.matrix(USmonthly_1990_to_2012[,indic.shock.name])
considered.variables <- c("GS1","LIP","LCPI","EBP")
Y <- as.matrix(USmonthly_1990_to_2012[,considered.variables])
n <- length(considered.variables)
res.LP.IV <- make.LPIV.irf(Y,Z,
                           nb.periods.IRF = 20,
                           nb.lags.Y.4.control=4,
                           nb.lags.Z.4.control=4,
                           indic.plot = 1, # Plots are displayed if = 1.
                           confidence.interval = 0.90)

}
